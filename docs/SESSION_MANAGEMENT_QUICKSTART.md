# ä¼šè¯ç®¡ç†å¿«é€Ÿå¼€å§‹

## ğŸš€ 5åˆ†é’Ÿå¿«é€Ÿä½“éªŒ

### æ­¥éª¤1: æŸ¥çœ‹å½“å‰æ¨¡å¼

```bash
# å¯åŠ¨CLI
conda activate OntologyConstruction
python examples/workflow_cli.py
```

é»˜è®¤æ˜¯**å†…å­˜æ¨¡å¼**ï¼Œä½ ä¼šçœ‹åˆ°ï¼š
```
ğŸ’¡ å½“å‰ä½¿ç”¨å†…å­˜æ¨¡å¼ï¼Œä¼šè¯ä¸ä¼šæŒä¹…åŒ–
   ä¿®æ”¹ configs/chatbot_config.yaml ä¸­çš„ memory.type ä¸º 'sqlite' ä»¥å¯ç”¨ä¼šè¯ç®¡ç†
```

### æ­¥éª¤2: æµ‹è¯•åŸºæœ¬å‘½ä»¤ï¼ˆå†…å­˜æ¨¡å¼ï¼‰

```
ğŸ‘¤ ä½ : /help             # æŸ¥çœ‹æ‰€æœ‰å‘½ä»¤
ğŸ‘¤ ä½ : /sessions         # å†…å­˜æ¨¡å¼ä¸‹è¿”å›ç©ºåˆ—è¡¨
ğŸ‘¤ ä½ : /new test1        # åˆ›å»ºæ–°ä¼šè¯
ğŸ‘¤ ä½ : ä½ å¥½               # å¼€å§‹å¯¹è¯
ğŸ‘¤ ä½ : /history          # æŸ¥çœ‹å†å²
ğŸ‘¤ ä½ : /quit             # é€€å‡º
```

**é‡æ–°å¯åŠ¨**ï¼š
```bash
python examples/workflow_cli.py
```

ä½ ä¼šå‘ç°ä¹‹å‰çš„å¯¹è¯**å·²ä¸¢å¤±**ï¼ˆå†…å­˜æ¨¡å¼ç‰¹æ€§ï¼‰ã€‚

---

### æ­¥éª¤3: åˆ‡æ¢åˆ°SQLiteæ¨¡å¼

ç¼–è¾‘ `configs/chatbot_config.yaml`:

```yaml
chatbot:
  memory:
    type: "sqlite"  # æ”¹è¿™ä¸€è¡Œï¼ˆåŸæ¥æ˜¯ in_memoryï¼‰
    sqlite_path: "data/chatbot_memory.db"
```

ä¿å­˜åé‡å¯CLIï¼š
```bash
python examples/workflow_cli.py
```

ç°åœ¨ä½ ä¼šçœ‹åˆ°ï¼š
```
ğŸ“Œ å·²åˆ›å»ºæ–°ä¼šè¯: 20251027_1137_abc123
```

---

### æ­¥éª¤4: æµ‹è¯•ä¼šè¯æŒä¹…åŒ–

**ç¬¬ä¸€æ¬¡è¿è¡Œ**ï¼š
```
ğŸ‘¤ [abc123] ä½ : æˆ‘æƒ³åˆæˆé˜¿å¸åŒ¹æ—
ğŸ¤– åŠ©æ‰‹: å¥½çš„ï¼...
ğŸ‘¤ [abc123] ä½ : /history
[æ˜¾ç¤ºå¯¹è¯å†å²]
ğŸ‘¤ [abc123] ä½ : /quit
```

**ç¬¬äºŒæ¬¡è¿è¡Œ**ï¼ˆæ¨¡æ‹Ÿé‡å¯ï¼‰ï¼š
```bash
python examples/workflow_cli.py
```

ä½ ä¼šçœ‹åˆ°ï¼š
```
ğŸ“¦ æ£€æµ‹åˆ° 1 ä¸ªå†å²ä¼šè¯
   ä½¿ç”¨ /sessions æŸ¥çœ‹æ‰€æœ‰ä¼šè¯
ğŸ“Œ å½“å‰ä¼šè¯: 20251027_1137_abc123  # è‡ªåŠ¨æ¢å¤ï¼
```

```
ğŸ‘¤ [abc123] ä½ : /history
[æ˜¾ç¤ºä¹‹å‰çš„å¯¹è¯ï¼Œå†…å®¹ä¿ç•™ï¼]
```

---

### æ­¥éª¤5: å¤šä¼šè¯ç®¡ç†

```
ğŸ‘¤ [abc123] ä½ : /sessions
==================================================
æ‰€æœ‰ä¼šè¯åˆ—è¡¨
==================================================

ğŸ‘‰ 20251027_1137_abc123
   æ¶ˆæ¯æ•°: 4
   é¢„è§ˆ: æˆ‘æƒ³åˆæˆé˜¿å¸åŒ¹æ—...

ğŸ‘¤ [abc123] ä½ : /new aspirin_project
âœ… å·²åˆ›å»ºæ–°ä¼šè¯: aspirin_project

ğŸ‘¤ [aspirin] ä½ : è¿™æ˜¯ä¸€ä¸ªæ–°çš„ä¼šè¯
ğŸ¤– åŠ©æ‰‹: ...

ğŸ‘¤ [aspirin] ä½ : /sessions
==================================================
æ‰€æœ‰ä¼šè¯åˆ—è¡¨
==================================================

   20251027_1137_abc123
   æ¶ˆæ¯æ•°: 4

ğŸ‘‰ aspirin_project
   æ¶ˆæ¯æ•°: 2

ğŸ‘¤ [aspirin] ä½ : /switch 20251027_1137_abc123
âœ… å·²åˆ‡æ¢åˆ°ä¼šè¯: 20251027_1137_abc123

ğŸ‘¤ [abc123] ä½ : /history
[æ˜¾ç¤ºåŸæ¥ä¼šè¯çš„å†å²]
```

---

## ğŸ¯ å®é™…ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: å¤šé¡¹ç›®å¹¶è¡Œç ”å‘

```yaml
# configs/chatbot_config.yaml
memory:
  type: "sqlite"
```

```
# é¡¹ç›®Aï¼šé˜¿å¸åŒ¹æ—åˆæˆ
ğŸ‘¤ ä½ : /new aspirin_synthesis
ğŸ‘¤ [aspirin] ä½ : æˆ‘æƒ³ç”¨æ°´æ¨é…¸åˆæˆé˜¿å¸åŒ¹æ—
ğŸ‘¤ [aspirin] ä½ : /generate
[ç”Ÿæˆä»»åŠ¡ID: task_001]

# é¡¹ç›®Bï¼šé’éœ‰ç´ ç ”ç©¶
ğŸ‘¤ [aspirin] ä½ : /new penicillin_research
ğŸ‘¤ [penicillin] ä½ : æˆ‘éœ€è¦ç ”ç©¶é’éœ‰ç´ çš„åˆæˆè·¯çº¿
ğŸ‘¤ [penicillin] ä½ : /generate
[ç”Ÿæˆä»»åŠ¡ID: task_002]

# å›åˆ°é¡¹ç›®AæŸ¥çœ‹ç»“æœ
ğŸ‘¤ [penicillin] ä½ : /switch aspirin_synthesis
ğŸ‘¤ [aspirin] ä½ : /view task_001
[æŸ¥çœ‹é˜¿å¸åŒ¹æ—æ–¹æ¡ˆ]

# ç¬¬äºŒå¤©ï¼šç»§ç»­é¡¹ç›®A
$ python examples/workflow_cli.py
ğŸ“¦ æ£€æµ‹åˆ° 2 ä¸ªå†å²ä¼šè¯
ğŸ‘¤ [penicillin] ä½ : /sessions
ğŸ‘¤ [penicillin] ä½ : /switch aspirin_synthesis
ğŸ‘¤ [aspirin] ä½ : /history
[å›é¡¾æ˜¨å¤©çš„è®¨è®º]
```

---

### ç¤ºä¾‹2: ä¸´æ—¶æµ‹è¯•ï¼ˆå†…å­˜æ¨¡å¼ï¼‰

```yaml
# configs/chatbot_config.yaml
memory:
  type: "in_memory"
```

```
# å¿«é€Ÿæµ‹è¯•æ–°åŠŸèƒ½
ğŸ‘¤ ä½ : å¸®æˆ‘æµ‹è¯•ä¸€ä¸‹MOSESæŸ¥è¯¢
ğŸ‘¤ ä½ : /quit  # é€€å‡ºåä¸ä¿å­˜å†å²
```

**ä¼˜ç‚¹**ï¼š
- å¯åŠ¨å¿«ï¼ˆæ— éœ€è¯»å–æ•°æ®åº“ï¼‰
- ä¸å ç”¨ç£ç›˜ç©ºé—´
- é€‚åˆå¿«é€Ÿæµ‹è¯•

---

## ğŸ“‹ å‘½ä»¤é€ŸæŸ¥å¡

### ä¼šè¯ç®¡ç†
| å‘½ä»¤ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `/sessions` | åˆ—å‡ºæ‰€æœ‰ä¼šè¯ | `/sessions` |
| `/switch <id>` | åˆ‡æ¢ä¼šè¯ | `/switch aspirin_project` |
| `/new [name]` | åˆ›å»ºæ–°ä¼šè¯ | `/new my_project` |
| `/history` | æŸ¥çœ‹å½“å‰ä¼šè¯å†å² | `/history` |

### ä»»åŠ¡ç®¡ç†
| å‘½ä»¤ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `/generate` | ç”Ÿæˆå®éªŒæ–¹æ¡ˆ | `/generate` |
| `/status` | æŸ¥çœ‹ä»»åŠ¡çŠ¶æ€ | `/status` |
| `/tasks` | åˆ—å‡ºæ‰€æœ‰ä»»åŠ¡ | `/tasks` |
| `/view <id>` | æŸ¥çœ‹æ–¹æ¡ˆ | `/view abc123` |

### å…¶ä»–
| å‘½ä»¤ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `/help` | æ˜¾ç¤ºå¸®åŠ© | `/help` |
| `/clear` | æ¸…å±ï¼ˆä¸åˆ é™¤å†å²ï¼‰ | `/clear` |
| `/quit` | é€€å‡º | `/quit` |

---

## ğŸ”§ é…ç½®æ¨¡æ¿

### å†…å­˜æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰
```yaml
# configs/chatbot_config.yaml
chatbot:
  llm:
    provider: "qwen"
    model_name: "qwen-plus"
    temperature: 0.7
    max_tokens: 4096
    enable_thinking: true

  moses:
    max_workers: 4
    query_timeout: 600

  memory:
    type: "in_memory"  # å†…å­˜æ¨¡å¼

  system_prompt: |
    ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„åŒ–å­¦å®éªŒåŠ©æ‰‹...
```

### SQLiteæ¨¡å¼ï¼ˆæ¨èï¼‰
```yaml
# configs/chatbot_config.yaml
chatbot:
  llm:
    provider: "qwen"
    model_name: "qwen-plus"
    temperature: 0.7
    max_tokens: 4096
    enable_thinking: true

  moses:
    max_workers: 4
    query_timeout: 600

  memory:
    type: "sqlite"  # SQLiteæ¨¡å¼
    sqlite_path: "data/chatbot_memory.db"  # æ•°æ®åº“è·¯å¾„

  system_prompt: |
    ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„åŒ–å­¦å®éªŒåŠ©æ‰‹...
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•æŸ¥çœ‹ä¿å­˜äº†å“ªäº›ä¼šè¯ï¼Ÿ

**A**: ä½¿ç”¨ `/sessions` å‘½ä»¤ï¼ˆä»…SQLiteæ¨¡å¼ï¼‰

### Q2: å¯ä»¥åˆ é™¤æ—§ä¼šè¯å—ï¼Ÿ

**A**: ç›®å‰éœ€è¦æ‰‹åŠ¨æ“ä½œæ•°æ®åº“ï¼š
```bash
sqlite3 data/chatbot_memory.db "DELETE FROM checkpoints WHERE thread_id = 'old_session';"
```

æœªæ¥ç‰ˆæœ¬ä¼šæ·»åŠ  `/delete <session_id>` å‘½ä»¤ã€‚

### Q3: å†…å­˜æ¨¡å¼èƒ½å¦åˆ—å‡ºä¼šè¯ï¼Ÿ

**A**: ä¸èƒ½ã€‚å†…å­˜æ¨¡å¼ä¸æ”¯æŒ `/sessions` å‘½ä»¤ï¼Œä¼šæç¤ºåˆ‡æ¢åˆ°SQLiteæ¨¡å¼ã€‚

### Q4: åˆ‡æ¢æ¨¡å¼ååŸæ¥çš„ä¼šè¯æ€ä¹ˆåŠï¼Ÿ

**A**:
- å†…å­˜â†’SQLiteï¼šåŸæ¥çš„ä¼šè¯ä¸¢å¤±ï¼ˆå†…å­˜æ¨¡å¼ä¸æŒä¹…åŒ–ï¼‰
- SQLiteâ†’å†…å­˜ï¼šæ•°æ®åº“æ–‡ä»¶ä¿ç•™ï¼Œåˆ‡å›SQLiteåå¯æ¢å¤

### Q5: æ•°æ®åº“æ–‡ä»¶åœ¨å“ªé‡Œï¼Ÿ

**A**: é»˜è®¤è·¯å¾„ `data/chatbot_memory.db`ï¼ˆå¯åœ¨é…ç½®ä¸­ä¿®æ”¹ï¼‰

---

## ğŸ“š å®Œæ•´æ–‡æ¡£

è¯¦ç»†è¯´æ˜è¯·å‚è€ƒï¼š[SESSION_MANAGEMENT.md](./SESSION_MANAGEMENT.md)

åŒ…å«ï¼š
- æŠ€æœ¯ç»†èŠ‚
- æ•…éšœæ’é™¤
- æœ€ä½³å®è·µ
- APIå‚è€ƒ
